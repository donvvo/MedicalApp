{% extends "base.html" %}

{% load staticfiles %}

{% block content %}

<!-- Page Titles -->
<div class="page-title">
    <div class="container">
        <h1>Profile Edit</h1>
        <div class="pagenation"><a href="{% url 'home' %}">Home</a> <i>></i> Clinic Profile</div>
    </div>
</div>
<!-- End Page Titles -->

<!-- Single Doctor-->
<section class="profile-doctor generic animated fadeInUp">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="section-title">
                    <h3>General Info</h3>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                <form id="request" action="{{request.path}}" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="row">
                    <div class="col-sm-3 text-center">
                        <figure>
                            {% if initial_image %}
                            <img id="preview" src="{{initial_image.url}}" class="img-responsive" alt="">
                            {% else %}
                            <img id="preview" src="{% static 'img/profile-img.png' %}" class="img-responsive" alt="">
                            {% endif %}
                        </figure>
                        {{user_form.image}}

                    </div>
                    <div class="col-sm-7">


        <div class="row">
            <div class="col-sm-12">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label for="name" class="sr-only">Name</label>
                                    {{form.name}}
                                </div>
                                <div class="form-group">
                                    <label for="phone" class="sr-only">Phone number</label>
                                    {{form.phone}}
                                </div>
                                <div class="form-group">
                                    <label for="email" class="sr-only">Email</label>
                                    {{user_form.email}}
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-12">
                                <div class="form-group">
                                    <label for="description" class="sr-only">Description</label>
                                    <i class="glyphicon glyphicon-pencil">{{form.description}}</i>
                                </div>
                            </div>
                        </div>


                        <div class="row">
            <div class="col-sm-12">
                <div class="section-title">
                    <h3>Address </h3>
                </div>
            </div>
        </div>
                        <div class="row">
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label for="address1" class="sr-only">Address 1</label>
                                {{form.address}}
                            </div>
                            <div class="form-group">
                                <label for="postal" class="sr-only">City</label>
                                {{form.city}}
                            </div>

                        </div>
                        <div class="col-sm-6">
                            <div class="form-group">
                                <label for="postal" class="sr-only">Postal Code</label>
                                {{form.postal_code}}
                            </div>

                        </div>
                        </div>


                        <div class="row">
                                <div class="col-sm-12">
                                    <div class="section-title">
                                        <h3>Hours</h3>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                            <div class="col-sm-2"><h6>Monday</h6></div>
                                            <div class="col-sm-5">
                                                <div class="form-group">
                                                    {% for error in form.start_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                    {{form.start_time_mon}}
                                                </div>
                                            </div>
                                            <div class="col-sm-5">
                                                {% for error in form.end_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                <div class="form-group">
                                                    {{form.end_time_mon}}
                                                </div>
                                            </div>
                                        </div>
                            <div class="row">
                                            <div class="col-sm-2"><h6>TUESDAY</h6></div>
                                            <div class="col-sm-5">
                                                <div class="form-group">
                                                    {% for error in form.start_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                    {{form.start_time_tue}}
                                                </div>
                                            </div>
                                            <div class="col-sm-5">
                                                {% for error in form.end_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                <div class="form-group">
                                                    {{form.end_time_tue}}
                                                </div>
                                            </div>
                                        </div>
                            <div class="row">
                                            <div class="col-sm-2"><h6>WEDNESDAY</h6></div>
                                            <div class="col-sm-5">
                                                <div class="form-group">
                                                    {% for error in form.start_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                    {{form.start_time_wed}}
                                                </div>
                                            </div>
                                            <div class="col-sm-5">
                                                {% for error in form.end_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                <div class="form-group">
                                                    {{form.end_time_wed}}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-2"><h6>THURSDAY</h6></div>
                                            <div class="col-sm-5">
                                                <div class="form-group">
                                                    {% for error in form.start_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                    {{form.start_time_thurs}}
                                                </div>
                                            </div>
                                            <div class="col-sm-5">
                                                {% for error in form.end_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                <div class="form-group">
                                                    {{form.end_time_thurs}}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-2"><h6>FRIDAY</h6></div>
                                            <div class="col-sm-5">
                                                <div class="form-group">
                                                    {% for error in form.start_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                    {{form.start_time_fri}}
                                                </div>
                                            </div>
                                            <div class="col-sm-5">
                                                {% for error in form.end_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                <div class="form-group">
                                                    {{form.end_time_fri}}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-2"><h6>SATURDAY</h6></div>
                                            <div class="col-sm-5">
                                                <div class="form-group">
                                                    {% for error in form.start_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                    {{form.start_time_sat}}
                                                </div>
                                            </div>
                                            <div class="col-sm-5">
                                                {% for error in form.end_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                <div class="form-group">
                                                    {{form.end_time_sat}}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-2"><h6>SUNDAY</h6></div>
                                            <div class="col-sm-5">
                                                <div class="form-group">
                                                    {% for error in form.start_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                    {{form.start_time_sun}}
                                                </div>
                                            </div>
                                            <div class="col-sm-5">
                                                {% for error in form.end_time.errors %}
                                                      <span class="errorlist">{{error}}</span>
                                                    {% endfor %}
                                                <div class="form-group">
                                                    {{form.end_time_sun}}
                                                </div>
                                            </div>
                                        </div>



        <div class="row">
            <div class="col-sm-12 text-center">
                <div class="section-title">
                    <h3>Doctors</h3>
                </div>
                <a href="{% url 'medical_appointments:add_doctor' object.url_name %}" class="btn btn-default btn-color-bg-dark-icon"><span>Add Doctor</span></a>
            </div>
        </div>


        <div class="row">
            <div class="col-sm-12">
                <ul class="media-list">
                    {% for doctor in object.doctor_set.all %}
                        <li class="media row">
                        <div class="col-xs-8 col-md-8">
                            <a class="pull-left" href="{% url 'users:doctor_profile' doctor.user.pk %}">
                                <img class="media-object img-circle" src="{% static 'img/news/news-thumbnail-144x144-01.jpg' %}" alt="//">
                            </a>
                            <div class="media-body">
                                <h5 class="media-heading"><a href="{% url 'users:doctor_profile' doctor.user.pk %}">&nbsp;{{doctor.user.first_name}} {{doctor.user.last_name}}</a></h5>
                                <p class="media-meta">&nbsp;{{doctor.specialty}}</p>
                            </div>
                        </div>
                            <div class="col-xs-4 col-md-4 text-center">
                            <a href="#" class="remove-doctor-btn" type="button" data-toggle="modal" data-target="#myModal" data-doctor="{{doctor.user.pk}}"><span class="glyphicon glyphicon-remove-sign"></span></a>
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>




                    <br><hr>


                        <input type="submit" class="btn btn-default btn-color-border-solid" value="Save">
            </div>
        </div>


                    </div>
                        <div class="col-sm-2">
                            <hr>
                            <input type="submit" class="btn btn-default btn-color-bg-dark-border" value="Delete Clinic" name="Delete">
                        </div>
                    </form>


                </div>

            </div>

        </div>

    </div>
</section>
<!-- End News -->


<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Are you sure you want to delete this doctor?</h4>
      </div>

      <div class="modal-footer">
        <form action="{{request.path}}" method="post" accept-charset="utf-8">
        {% csrf_token %}
            <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
            <input id="delete-doctor-btn" type="submit" class="btn btn-primary" value="Yes" name="DeleteDoctor">
            <input id="doctor-id" type="hidden" name="doctor_id" value="">
        </form>
      </div>
    </div>
  </div>
</div>

{% endblock content %}

{% block javascript %}

{{block.super}}

<script>
$(function() {
    $('.remove-doctor-btn').click(function() {
        var doctor = $(this).attr('data-doctor');
        $('#doctor-id').val(doctor);
    });
    $("#id_image").addClass('file-loading');
    $("#id_image").fileinput({
        browseClass: "btn btn-default btn-color-bg btn-no-radius",
        browseLabel: "Change Photo",
        showPreview: false,
        showCaption: false,
        showUpload: false,
        showUploadedThumbs: false
    });
    $('#id_image').on('fileloaded', function(event, file, previewId, index, reader) {
        $('#preview').attr('src', URL.createObjectURL(file));
    });
    $('#id_image').on('fileclear', function(event) {
        console.log('remove');
        $('#preview').attr('src', "{% static 'img/profile-img.png' %}");
    });
});
</script>

{% endblock javascript %}
